{"author":{"id":"2d08e4816aca0a07db9878f126b0e7f6d6f1362eb9bc4804be6b33ff8d0a19ec"},"ops":[{"type":3,"timestamp":1728939891,"nonce":"IL/jaDfmtfBVjcjrEtsV0pYZ3Yw=","metadata":{"github-id":"IC_kwDOJl1IZM6PyW2v","github-url":"https://github.com/nikitabobko/AeroSpace/issues/336#issuecomment-2412342703"},"message":"Yeah, I was typing the same thing.\n\nI have 3 monitors ordered along x-axis from left to right: Built-in Retina Display, DELL U2723QE, DeskPad Display. AeroSpace predictably uses plain left to right order:\n```\n1 | Built-in Retina Display\n2 | DELL U2723QE\n3 | DeskPad Display\n```\n\nBut the following code:\n```\nprint(NSScreen.screens.enumerated()\n    .map {\n        (\n            \"Apple NSScreenNumber API: \\($0.element.deviceDescription[NSDeviceDescriptionKey(\"NSScreenNumber\")] as! CGDirectDisplayID)\",\n            \"NSScreen.screens index: \\($0.offset + 1)\",\n            $0.element.localizedName\n        )\n    }\n)\n```\nprints the following (I wrapped elements of the array on new lines for easier readability):\n```\n[\n    (\"Apple NSScreenNumber API: 2\", \"NSScreen.screens index: 1\", \"DELL U2723QE\"),\n    (\"Apple NSScreenNumber API: 1\", \"NSScreen.screens index: 2\", \"Built-in Retina Display\"),\n    (\"Apple NSScreenNumber API: 7\", \"NSScreen.screens index: 3\", \"DeskPad Display\")\n]\n```\n\nThe Apple documented `NSScreenNumber` simply doesn't make sense.","files":null},{"type":6,"timestamp":1728940044,"nonce":"8flVzCOnYNu0dB/dLzcEMZelkd0=","metadata":{"github-id":"UCE_lALOJl1IZM6PyW2vzlJH5Og"},"target":"33720122aad5c4efda1e16eac13cf8f22b63288d91d31b26a00c8153e9adfee1","message":"Yeah, I was typing the same thing.\n\nI have 3 monitors ordered along x-axis from left to right: Built-in Retina Display, DELL U2723QE (main monitor), DeskPad Display. AeroSpace predictably uses plain left to right order:\n```\n1 | Built-in Retina Display\n2 | DELL U2723QE\n3 | DeskPad Display\n```\n\nBut the following code:\n```\nprint(NSScreen.screens.enumerated()\n    .map {\n        (\n            \"Apple NSScreenNumber API: \\($0.element.deviceDescription[NSDeviceDescriptionKey(\"NSScreenNumber\")] as! CGDirectDisplayID)\",\n            \"NSScreen.screens index: \\($0.offset + 1)\",\n            $0.element.localizedName\n        )\n    }\n)\n```\nprints the following (I wrapped elements of the array on new lines for easier readability):\n```\n[\n    (\"Apple NSScreenNumber API: 2\", \"NSScreen.screens index: 1\", \"DELL U2723QE\"),\n    (\"Apple NSScreenNumber API: 1\", \"NSScreen.screens index: 2\", \"Built-in Retina Display\"),\n    (\"Apple NSScreenNumber API: 7\", \"NSScreen.screens index: 3\", \"DeskPad Display\")\n]\n```\n\nThe Apple documented `NSScreenNumber` simply doesn't make sense.","files":null},{"type":6,"timestamp":1728940081,"nonce":"bfspqSWwyo9t5FR+Cg3acBP32DA=","metadata":{"github-id":"UCE_lALOJl1IZM6PyW2vzlJH6Ek"},"target":"33720122aad5c4efda1e16eac13cf8f22b63288d91d31b26a00c8153e9adfee1","message":"Yeah, I was typing the same thing.\n\nI have 3 monitors ordered along x-axis from left to right: Built-in Retina Display, DELL U2723QE (main monitor), DeskPad Display. AeroSpace predictably uses plain left to right order:\n```\n1 | Built-in Retina Display\n2 | DELL U2723QE\n3 | DeskPad Display\n```\n\nBut the following code:\n```\nprint(NSScreen.screens.enumerated()\n    .map {\n        (\n            \"Apple NSScreenNumber API: \\($0.element.deviceDescription[NSDeviceDescriptionKey(\"NSScreenNumber\")] as! CGDirectDisplayID)\",\n            \"NSScreen.screens index: \\($0.offset + 1)\",\n            $0.element.localizedName\n        )\n    }\n)\n```\nprints the following (I wrapped elements of the array on new lines for easier readability):\n```\n[\n    (\"Apple NSScreenNumber API: 2\", \"NSScreen.screens index: 1\", \"DELL U2723QE\"),\n    (\"Apple NSScreenNumber API: 1\", \"NSScreen.screens index: 2\", \"Built-in Retina Display\"),\n    (\"Apple NSScreenNumber API: 7\", \"NSScreen.screens index: 3\", \"DeskPad Display\")\n]\n```\n\nThe Apple documented `NSScreenNumber` is different","files":null},{"type":3,"timestamp":1728942095,"nonce":"W2d4PuhmgzjuSOUBX0/Pbh3lMbk=","metadata":{"github-id":"IC_kwDOJl1IZM6PyiBm","github-url":"https://github.com/nikitabobko/AeroSpace/issues/336#issuecomment-2412388454"},"message":"The following commit implements `%{monitor-appkit-nsscreen-screens-id}` https://github.com/nikitabobko/AeroSpace/commit/125e9b94040e95204c6a05cd5089022ba92efbce which so far looks identical to the private API that sketchybar uses. But nobody guaranteed that, and nobody guarantees that sketchybar order (that uses private `SLSCopyManagedDisplays` API) will remain the same as `%{monitor-appkit-nsscreen-screens-id}` (which uses public `NSScreen.screens`, but order is undocumented by Apple)\n\nIf you want stronger guarantees please reach out to sketchybar developer for a feature request to expose/interpret monitor IDs accessible via public API or at least predictably stable order. For example, AeroSpace uses its own predictably stable order by sorting by `minX` and then `minY` https://github.com/nikitabobko/AeroSpace/blob/898331e79086bd7f56fc4588308bc3819587a320/Sources/AppBundle/model/Monitor.swift#L83 Point (0, 0) is the top left corner of the main monitor, x-axis points to the right, y-axis points down. Or, as it was mentioned, `deviceDescription[NSDeviceDescriptionKey(\"NSScreenNumber\")]` is also a good alternative (the returned number is funky, but at least it's documented)\n\nI will close this issue when the commit is released","files":null}]}