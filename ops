{"author":{"id":"2d08e4816aca0a07db9878f126b0e7f6d6f1362eb9bc4804be6b33ff8d0a19ec"},"ops":[{"type":3,"timestamp":1735840680,"nonce":"NrXsvPoJaO7wiHk5s9GY7sJ2hNM=","metadata":{"github-id":"IC_kwDOJl1IZM6ZEvHn","github-url":"https://github.com/nikitabobko/AeroSpace/issues/101#issuecomment-2568155623"},"message":"@ok-nick thanks for the pointers.\n\n**Below are my thoughts out loud. I don't know the final decision yet.**\n\nThis issue is irritating. At least it was for me, until I discovered the workaround to disable \"Displays have separate Spaces\", and I personally is fine to disable it, since Spaces are cursed in some many different ways.\n\nBut I think I'm _maybe_ fine to use private APIs specifically for this issue, but only when:\n- \"Displays have separate Spaces\" is enabled. It's possible to check it with `NSScreen.screensHaveSeparateSpaces`\n- The window that we want to focus is located on a different monitor\n- _Maybe_ add an option in config to allow usage of private API in this case, but I don't like to overwhelm the config with such options. I want everything to work right out of the box. Agghhh\n- Assignment for the readers: think about other ways to restrict the usage of private API?\n\nI like the \"tagline\" in the README that `_AXUIElementGetWindow` is the only private API that we use right now, and if we use another private API, it won't longer be true, and we'd have to change the tagline...\n\nThe other concern is maintability. We should answer the question \"what will we do, when this API stops working?\". The answer is probably: \"we will _just_ reintroduce this #101 bug\", and fallback to only using the public API as we did before.\n\nIDK. Other thoughts are welcome","files":null},{"type":6,"timestamp":1735840851,"nonce":"ocJkOjPuC3sWFOEAp9XX1MsRxbA=","metadata":{"github-id":"UCE_lALOJl1IZM6ZEvHnzljM3Js"},"target":"364881527a6598411203cf478cf35ec93a7f3ece966caebf4585b794c39675af","message":"@ok-nick thanks for the pointers.\n\n**Below are my thoughts out loud. I don't know the final decision yet.**\n\nThis issue is irritating. At least it was for me, until I discovered the workaround to disable \"Displays have separate Spaces\", and I personally is fine to disable it, since Spaces are cursed in some many different ways.\n\nBut I think I'm _maybe_ fine to use private APIs specifically for this issue, but only when:\n- \"Displays have separate Spaces\" is enabled. It's possible to check it with `NSScreen.screensHaveSeparateSpaces`\n- The window that we want to focus is located on a different monitor\n- _Maybe_ add an option in config to allow usage of private API in this case, but I don't like to overwhelm the config with such options. I want everything to work right out of the box. Agghhh\n- Assignment for the readers: think about other ways to restrict the usage of private API?\n\nI like the \"tagline\" in the README that `_AXUIElementGetWindow` is the only private API that we use right now, and if we use another private API, it won't longer be true, and we'd have to change the tagline...\n\nThe other concern is maintability. We should answer the question \"what will we do, when this API stops working?\". The answer is probably: \"we will _just_ reintroduce this #101 bug\", and fallback to only using the public API as we did before. Also, we should make it so that people will have a clear workaround when the API breaks without updating AeroSpace, so that I'd not need to create a hotfix from my phone via SSH when I'm on vacation.\n\nIDK. Other thoughts are welcome","files":null},{"type":6,"timestamp":1735840887,"nonce":"iwwR93NAntMdCL/oQvpqjzdMN1I=","metadata":{"github-id":"UCE_lALOJl1IZM6ZEvHnzljM34M"},"target":"364881527a6598411203cf478cf35ec93a7f3ece966caebf4585b794c39675af","message":"@ok-nick thanks for the pointers.\n\n**Below are my thoughts out loud. I don't know the final decision yet.**\n\nThis issue is irritating. At least it was for me, until I discovered the workaround to disable \"Displays have separate Spaces\", and I personally is fine to disable it, since Spaces are cursed in some many different ways.\n\nBut I think I'm _maybe_ fine to use private APIs specifically for this issue, but only when:\n- \"Displays have separate Spaces\" is enabled. It's possible to check it with `NSScreen.screensHaveSeparateSpaces`\n- The window that we want to focus is located on a different monitor\n- _Maybe_ add an option in config to allow usage of private API in this case, but I don't like to overwhelm the config with such options. I want everything to work right out of the box. Agghhh\n- Assignment for the readers: think about other ways to restrict the usage of private API?\n\nI like the \"tagline\" in the README that `_AXUIElementGetWindow` is the only private API that we use right now, and if we use another private API, it won't longer be true, and we'd have to change the tagline...\n\nThe other concern is maintability. We should answer the question \"what will we do, when this API stops working?\". The answer is probably: \"we will _just_ reintroduce this #101 bug\", and fallback to only using the public API as we did before. Also, we should make it so that people have a clear workaround when the API breaks without updating AeroSpace, so that I'd not need to create a hotfix from my phone via SSH when I'm on vacation.\n\nIDK. Other thoughts are welcome","files":null},{"type":3,"timestamp":1735844658,"nonce":"Ci82S4cPDSb76ncGtvxG3gqVsMw=","metadata":{"github-id":"IC_kwDOJl1IZM6ZFDXk","github-url":"https://github.com/nikitabobko/AeroSpace/issues/101#issuecomment-2568238564"},"message":"I've come up with the following idea:\n\n1. Before using the private API, AeroSpace guards itself by setting a [UserDefaults](https://developer.apple.com/documentation/foundation/userdefaults) `i-am-about-to-use-private-api-to-reliably-focus-window-on-another-monitor` boolean flag to `true`\n2. AeroSpace uses the API\n3. If we survived the call, AeroSpace resets `i-am-about-to-use-private-api-to-reliably-focus-window-on-another-monitor` back to `false`\n\nOn AeroSpace startup (in `initAppBundle` function), AeroSpace checks if `i-am-about-to-use-private-api-to-reliably-focus-window-on-another-monitor` set to `true`. If it's set to `true`, it means that we probably crashed by using the private API. In that case, AeroSpace sets another UserDefaults boolean flag `i-will-never-use-this-focus-window-on-another-monitor-broken-private-api-from-now-on` to `true` and doesn't use the private API anymore.\n\nOpen question: should AeroSpace show the dialog and explain to user what happened when `i-will-never-use-this-focus-window-on-another-monitor-broken-private-api-from-now-on` is set to `true`? Probably yes. With the prompt to report a GitHub issue and mention macOS version.\n\nAnd as suggested before, the API should be used only when:\n- \"Displays have separate Spaces\" is enabled\n- The window that we want to focus is located on a different monitor\n\nPRs that implement the idea are welcome. The issue is not the top-priority for me at this moment.","files":null}]}